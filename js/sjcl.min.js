"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(b){this.toString=function(){return"CORRUPT: "+this.message};this.message=b},invalid:function(b){this.toString=function(){return"INVALID: "+this.message};this.message=b},bug:function(b){this.toString=function(){return"BUG: "+this.message};this.message=b},notReady:function(b){this.toString=function(){return"NOT READY: "+this.message};this.message=b}}};sjcl.cipher.aes=function(j){this.s[0][0][0]||this.O();var i,p,o,n,m=this.s[0][4],l=this.s[1];i=j.length;var k=1;if(4!==i&&6!==i&&8!==i){throw new sjcl.exception.invalid("invalid aes key size")}this.b=[o=j.slice(0),n=[]];for(j=i;j<4*i+28;j++){p=o[j-1];if(0===j%i||8===i&&4===j%i){p=m[p>>>24]<<24^m[p>>16&255]<<16^m[p>>8&255]<<8^m[p&255],0===j%i&&(p=p<<8^p>>>24^k<<24,k=k<<1^283*(k>>7))}o[j]=o[j-i]^p}for(i=0;j;i++,j--){p=o[i&3?j:j-4],n[i]=4>=j||4>i?p:l[0][m[p>>>24]]^l[1][m[p>>16&255]]^l[2][m[p>>8&255]]^l[3][m[p&255]]}};sjcl.cipher.aes.prototype={encrypt:function(b){return t(this,b,0)},decrypt:function(b){return t(this,b,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var L=this.s[0],K=this.s[1],J=L[4],I=K[4],x,w,v,s=[],r=[],q,j,o,i;for(x=0;256>x;x++){r[(s[x]=x<<1^283*(x>>7))^x]=x}for(w=v=0;!J[w];w^=q||1,v=r[v]||1){for(o=v^v<<1^v<<2^v<<3^v<<4,o=o>>8^o&255^99,J[w]=o,I[o]=w,j=s[x=s[q=s[w]]],i=16843009*j^65537*x^257*q^16843008*w,j=257*s[o]^16843008*o,x=0;4>x;x++){L[x][w]=j=j<<24^j>>>8,K[x][o]=i=i<<24^i>>>8}}for(x=0;5>x;x++){L[x]=L[x].slice(0),K[x]=K[x].slice(0)}}};function t(V,U,T){if(4!==U.length){throw new sjcl.exception.invalid("invalid aes block size")}var S=V.b[T],R=U[0]^S[0],Q=U[T?3:1]^S[1],P=U[2]^S[2];U=U[T?1:3]^S[3];var O,N,M,K=S.length/4-2,L,J=4,s=[0,0,0,0];O=V.s[T];V=O[0];var I=O[1],o=O[2],j=O[3],i=O[4];for(L=0;L<K;L++){O=V[R>>>24]^I[Q>>16&255]^o[P>>8&255]^j[U&255]^S[J],N=V[Q>>>24]^I[P>>16&255]^o[U>>8&255]^j[R&255]^S[J+1],M=V[P>>>24]^I[U>>16&255]^o[R>>8&255]^j[Q&255]^S[J+2],U=V[U>>>24]^I[R>>16&255]^o[Q>>8&255]^j[P&255]^S[J+3],J+=4,R=O,Q=N,P=M}for(L=0;4>L;L++){s[T?3&-L:L]=i[R>>>24]<<24^i[Q>>16&255]<<16^i[P>>8&255]<<8^i[U&255]^S[J++],O=R,R=Q,Q=P,P=U,U=O}return s}sjcl.bitArray={bitSlice:function(e,d,f){e=sjcl.bitArray.$(e.slice(d/32),32-(d&31)).slice(1);return void 0===f?e:sjcl.bitArray.clamp(e,f-d)},extract:function(f,e,h){var g=Math.floor(-e-h&31);return((e+h-1^e)&-32?f[e/32|0]<<32-g^f[e/32+1|0]>>>g:f[e/32|0]>>>g)&(1<<h)-1},concat:function(f,e){if(0===f.length||0===e.length){return f.concat(e)}var h=f[f.length-1],g=sjcl.bitArray.getPartial(h);return 32===g?f.concat(e):sjcl.bitArray.$(e,g,h|0,f.slice(0,f.length-1))},bitLength:function(d){var c=d.length;return 0===c?0:32*(c-1)+sjcl.bitArray.getPartial(d[c-1])},clamp:function(e,d){if(32*e.length<d){return e}e=e.slice(0,Math.ceil(d/32));var f=e.length;d=d&31;0<f&&d&&(e[f-1]=sjcl.bitArray.partial(d,e[f-1]&2147483648>>d-1,1));return e},partial:function(e,d,f){return 32===e?d:(f?d|0:d<<32-e)+1099511627776*e},getPartial:function(b){return Math.round(b/1099511627776)||32},equal:function(f,e){if(sjcl.bitArray.bitLength(f)!==sjcl.bitArray.bitLength(e)){return !1}var h=0,g;for(g=0;g<f.length;g++){h|=f[g]^e[g]}return 0===h},$:function(g,f,j,i){var h;h=0;for(void 0===i&&(i=[]);32<=f;f-=32){i.push(j),j=0}if(0===f){return i.concat(g)}for(h=0;h<g.length;h++){i.push(j|g[h]>>>f),j=g[h]<<32-f}h=g.length?g[g.length-1]:0;g=sjcl.bitArray.getPartial(h);i.push(sjcl.bitArray.partial(f+g&31,32<f+g?j:i.pop(),1));return i},i:function(d,c){return[d[0]^c[0],d[1]^c[1],d[2]^c[2],d[3]^c[3]]},byteswapM:function(e){var d,f;for(d=0;d<e.length;++d){f=e[d],e[d]=f>>>24|f>>>8&65280|(f&65280)<<8|f<<24}return e}};sjcl.codec.utf8String={fromBits:function(g){var f="",j=sjcl.bitArray.bitLength(g),i,h;for(i=0;i<j/8;i++){0===(i&3)&&(h=g[i/4]),f+=String.fromCharCode(h>>>8>>>8>>>8),h<<=8}return decodeURIComponent(escape(f))},toBits:function(f){f=unescape(encodeURIComponent(f));var e=[],h,g=0;for(h=0;h<f.length;h++){g=g<<8|f.charCodeAt(h),3===(h&3)&&(e.push(g),g=0)}h&3&&e.push(sjcl.bitArray.partial(8*(h&3),g));return e}};sjcl.codec.hex={fromBits:function(e){var d="",f;for(f=0;f<e.length;f++){d+=((e[f]|0)+263882790666240).toString(16).substr(4)}return d.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(f){var e,h=[],g;f=f.replace(/\s|0x/g,"");g=f.length;f=f+"00000000";for(e=0;e<f.length;e+=8){h.push(parseInt(f.substr(e,8),16)^0)}return sjcl.bitArray.clamp(h,4*g)}};sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(v,s,r){var q=sjcl.codec.base32.BASE,p=sjcl.codec.base32.REMAINING,o="",n=0,m=sjcl.codec.base32.B,j=0,i=sjcl.bitArray.bitLength(v);r&&(m=sjcl.codec.base32.X);for(r=0;o.length*q<i;){o+=m.charAt((j^v[r]>>>n)>>>p),n<q?(j=v[r]<<q-n,n+=p,r++):(j<<=q,n-=q)}for(;o.length&7&&!s;){o+="="}return o},toBits:function(L,K){L=L.replace(/\s|=/g,"").toUpperCase();var J=sjcl.codec.base32.BITS,I=sjcl.codec.base32.BASE,x=sjcl.codec.base32.REMAINING,w=[],v,s=0,r=sjcl.codec.base32.B,q=0,j,o="base32";K&&(r=sjcl.codec.base32.X,o="base32hex");for(v=0;v<L.length;v++){j=r.indexOf(L.charAt(v));if(0>j){if(!K){try{return sjcl.codec.base32hex.toBits(L)}catch(i){}}throw new sjcl.exception.invalid("this isn't "+o+"!")}s>x?(s-=x,w.push(q^j>>>s),q=j<<J-s):(s+=I,q^=j<<J-s)}s&56&&w.push(sjcl.bitArray.partial(s&56,q,1));return w}};sjcl.codec.base32hex={fromBits:function(d,c){return sjcl.codec.base32.fromBits(d,c,1)},toBits:function(b){return sjcl.codec.base32.toBits(b,1)}};sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(j,i,p){var o="",n=0,m=sjcl.codec.base64.B,l=0,k=sjcl.bitArray.bitLength(j);p&&(m=m.substr(0,62)+"-_");for(p=0;6*o.length<k;){o+=m.charAt((l^j[p]>>>n)>>>26),6>n?(l=j[p]<<6-n,n+=26,p++):(l<<=6,n-=6)}for(;o.length&3&&!i;){o+="="}return o},toBits:function(j,i){j=j.replace(/\s|=/g,"");var p=[],o,n=0,m=sjcl.codec.base64.B,l=0,k;i&&(m=m.substr(0,62)+"-_");for(o=0;o<j.length;o++){k=m.indexOf(j.charAt(o));if(0>k){throw new sjcl.exception.invalid("this isn't base64!")}26<n?(n-=26,p.push(l^k>>>n),l=k<<32-n):(n+=6,l^=k<<32-n)}n&56&&p.push(sjcl.bitArray.partial(n&56,l,1));return p}};sjcl.codec.base64url={fromBits:function(b){return sjcl.codec.base64.fromBits(b,1,1)},toBits:function(b){return sjcl.codec.base64.toBits(b,1)}};sjcl.hash.sha256=function(b){this.b[0]||this.O();b?(this.F=b.F.slice(0),this.A=b.A.slice(0),this.l=b.l):this.reset()};sjcl.hash.sha256.hash=function(b){return(new sjcl.hash.sha256).update(b).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(g){"string"===typeof g&&(g=sjcl.codec.utf8String.toBits(g));var f,j=this.A=sjcl.bitArray.concat(this.A,g);f=this.l;g=this.l=f+sjcl.bitArray.bitLength(g);if(9007199254740991<g){throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits")}if("undefined"!==typeof Uint32Array){var i=new Uint32Array(j),h=0;for(f=512+f-(512+f&511);f<=g;f+=512){u(this,i.subarray(16*h,16*(h+1))),h+=1}j.splice(0,16*h)}else{for(f=512+f-(512+f&511);f<=g;f+=512){u(this,j.splice(0,16))}}return this},finalize:function(){var e,d=this.A,f=this.F,d=sjcl.bitArray.concat(d,[sjcl.bitArray.partial(1,1)]);for(e=d.length+2;e&15;e++){d.push(0)}d.push(Math.floor(this.l/4294967296));for(d.push(this.l|0);d.length;){u(this,d.splice(0,16))}this.reset();return f},Y:[],b:[],O:function(){function g(b){return 4294967296*(b-Math.floor(b))|0}for(var f=0,j=2,i,h;64>f;j++){h=!0;for(i=2;i*i<=j;i++){if(0===j%i){h=!1;break}}h&&(8>f&&(this.Y[f]=g(Math.pow(j,0.5))),this.b[f]=g(Math.pow(j,1/3)),f++)}}};function u(P,O){var N,M,L,K=P.F,J=P.b,I=K[0],x=K[1],w=K[2],s=K[3],v=K[4],o=K[5],i=K[6],j=K[7];for(N=0;64>N;N++){16>N?M=O[N]:(M=O[N+1&15],L=O[N+14&15],M=O[N&15]=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(L>>>17^L>>>19^L>>>10^L<<15^L<<13)+O[N&15]+O[N+9&15]|0),M=M+j+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(i^v&(o^i))+J[N],j=i,i=o,o=v,v=s+M|0,s=w,w=x,x=I,I=M+(x&w^s&(x^w))+(x>>>2^x>>>13^x>>>22^x<<30^x<<19^x<<10)|0}K[0]=K[0]+I|0;K[1]=K[1]+x|0;K[2]=K[2]+w|0;K[3]=K[3]+s|0;K[4]=K[4]+v|0;K[5]=K[5]+o|0;K[6]=K[6]+i|0;K[7]=K[7]+j|0}sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(b){sjcl.mode.ccm.G.push(b)},unListenProgress:function(b){b=sjcl.mode.ccm.G.indexOf(b);-1<b&&sjcl.mode.ccm.G.splice(b,1)},fa:function(e){var d=sjcl.mode.ccm.G.slice(),f;for(f=0;f<d.length;f+=1){d[f](e)}},encrypt:function(v,s,r,q,p){var o,n=s.slice(0),m=sjcl.bitArray,j=m.bitLength(r)/8,i=m.bitLength(n)/8;p=p||64;q=q||[];if(7>j){throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")}for(o=2;4>o&&i>>>8*o;o++){}o<15-j&&(o=15-j);r=m.clamp(r,8*(15-o));s=sjcl.mode.ccm.V(v,s,r,q,p,o);n=sjcl.mode.ccm.C(v,n,r,s,p,o);return m.concat(n.data,n.tag)},decrypt:function(v,s,r,q,p){p=p||64;q=q||[];var o=sjcl.bitArray,n=o.bitLength(r)/8,m=o.bitLength(s),j=o.clamp(s,m-p),i=o.bitSlice(s,m-p),m=(m-p)/8;if(7>n){throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")}for(s=2;4>s&&m>>>8*s;s++){}s<15-n&&(s=15-n);r=o.clamp(r,8*(15-s));j=sjcl.mode.ccm.C(v,j,r,i,p,s);v=sjcl.mode.ccm.V(v,j.data,r,q,p,s);if(!o.equal(j.tag,v)){throw new sjcl.exception.corrupt("ccm: tag doesn't match")}return j.data},na:function(r,q,p,o,n,m){var l=[],j=sjcl.bitArray,i=j.i;o=[j.partial(8,(q.length?64:0)|o-2<<2|m-1)];o=j.concat(o,p);o[3]|=n;o=r.encrypt(o);if(q.length){for(p=j.bitLength(q)/8,65279>=p?l=[j.partial(16,p)]:4294967295>=p&&(l=j.concat([j.partial(16,65534)],[p])),l=j.concat(l,q),q=0;q<l.length;q+=4){o=r.encrypt(i(o,l.slice(q,q+4).concat([0,0,0])))}}return o},V:function(j,i,p,o,n,m){var l=sjcl.bitArray,k=l.i;n/=8;if(n%2||4>n||16<n){throw new sjcl.exception.invalid("ccm: invalid tag length")}if(4294967295<o.length||4294967295<i.length){throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")}p=sjcl.mode.ccm.na(j,o,p,n,l.bitLength(i)/8,m);for(o=0;o<i.length;o+=4){p=j.encrypt(k(p,i.slice(o,o+4).concat([0,0,0])))}return l.clamp(p,8*n)},C:function(J,I,x,w,v,s){var r,q=sjcl.bitArray;r=q.i;var p=I.length,o=q.bitLength(I),i=p/50,j=i;x=q.concat([q.partial(8,s-1)],x).concat([0,0,0]).slice(0,4);w=q.bitSlice(r(w,J.encrypt(x)),0,v);if(!p){return{tag:w,data:[]}}for(r=0;r<p;r+=4){r>i&&(sjcl.mode.ccm.fa(r/p),i+=j),x[3]++,v=J.encrypt(x),I[r]^=v[0],I[r+1]^=v[1],I[r+2]^=v[2],I[r+3]^=v[3]}return{tag:w,data:q.clamp(I,o)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(L,K,J,I,x,w){if(128!==sjcl.bitArray.bitLength(J)){throw new sjcl.exception.invalid("ocb iv must be 128 bits")}var v,s=sjcl.mode.ocb2.S,r=sjcl.bitArray,q=r.i,j=[0,0,0,0];J=s(L.encrypt(J));var o,i=[];I=I||[];x=x||64;for(v=0;v+4<K.length;v+=4){o=K.slice(v,v+4),j=q(j,o),i=i.concat(q(J,L.encrypt(q(J,o)))),J=s(J)}o=K.slice(v);K=r.bitLength(o);v=L.encrypt(q(J,[0,0,0,K]));o=r.clamp(q(o.concat([0,0,0]),v),K);j=q(j,q(o.concat([0,0,0]),v));j=L.encrypt(q(j,q(J,s(J))));I.length&&(j=q(j,w?I:sjcl.mode.ocb2.pmac(L,I)));return i.concat(r.concat(o,r.clamp(j,x)))},decrypt:function(P,O,N,M,L,K){if(128!==sjcl.bitArray.bitLength(N)){throw new sjcl.exception.invalid("ocb iv must be 128 bits")}L=L||64;var J=sjcl.mode.ocb2.S,I=sjcl.bitArray,x=I.i,w=[0,0,0,0],s=J(P.encrypt(N)),v,o,i=sjcl.bitArray.bitLength(O)-L,j=[];M=M||[];for(N=0;N+4<i/32;N+=4){v=x(s,P.decrypt(x(s,O.slice(N,N+4)))),w=x(w,v),j=j.concat(v),s=J(s)}o=i-32*N;v=P.encrypt(x(s,[0,0,0,o]));v=x(v,I.clamp(O.slice(N),o).concat([0,0,0]));w=x(w,v);w=P.encrypt(x(w,x(s,J(s))));M.length&&(w=x(w,K?M:sjcl.mode.ocb2.pmac(P,M)));if(!I.equal(I.clamp(w,L),I.bitSlice(O,i))){throw new sjcl.exception.corrupt("ocb: tag doesn't match")}return j.concat(I.clamp(v,o))},pmac:function(j,i){var p,o=sjcl.mode.ocb2.S,n=sjcl.bitArray,m=n.i,l=[0,0,0,0],k=j.encrypt([0,0,0,0]),k=m(k,o(o(k)));for(p=0;p+4<i.length;p+=4){k=o(k),l=m(l,j.encrypt(m(k,i.slice(p,p+4))))}p=i.slice(p);128>n.bitLength(p)&&(k=m(k,o(k)),p=n.concat(p,[-2147483648,0,0,0]));l=m(l,p);return j.encrypt(m(o(m(k,o(k))),l))},S:function(b){return[b[0]<<1^b[1]>>>31,b[1]<<1^b[2]>>>31,b[2]<<1^b[3]>>>31,b[3]<<1^135*(b[0]>>>31)]}};sjcl.mode.gcm={name:"gcm",encrypt:function(h,g,l,k,j){var i=g.slice(0);g=sjcl.bitArray;k=k||[];h=sjcl.mode.gcm.C(!0,h,i,k,l,j||128);return g.concat(h.data,h.tag)},decrypt:function(j,i,p,o,n){var m=i.slice(0),l=sjcl.bitArray,k=l.bitLength(m);n=n||128;o=o||[];n<=k?(i=l.bitSlice(m,k-n),m=l.bitSlice(m,0,k-n)):(i=m,m=[]);j=sjcl.mode.gcm.C(!1,j,m,o,p,n);if(!l.equal(j.tag,i)){throw new sjcl.exception.corrupt("gcm: tag doesn't match")}return j.data},ka:function(j,i){var p,o,n,m,l,k=sjcl.bitArray.i;n=[0,0,0,0];m=i.slice(0);for(p=0;128>p;p++){(o=0!==(j[Math.floor(p/32)]&1<<31-p%32))&&(n=k(n,m));l=0!==(m[3]&1);for(o=3;0<o;o--){m[o]=m[o]>>>1|(m[o-1]&1)<<31}m[0]>>>=1;l&&(m[0]^=-520093696)}return n},j:function(g,f,j){var i,h=j.length;f=f.slice(0);for(i=0;i<h;i+=4){f[0]^=4294967295&j[i],f[1]^=4294967295&j[i+1],f[2]^=4294967295&j[i+2],f[3]^=4294967295&j[i+3],f=sjcl.mode.gcm.ka(f,g)}return f},C:function(P,O,N,M,L,K){var J,I,x,w,s,v,o,i,j=sjcl.bitArray;v=N.length;o=j.bitLength(N);i=j.bitLength(M);I=j.bitLength(L);J=O.encrypt([0,0,0,0]);96===I?(L=L.slice(0),L=j.concat(L,[1])):(L=sjcl.mode.gcm.j(J,[0,0,0,0],L),L=sjcl.mode.gcm.j(J,L,[0,0,Math.floor(I/4294967296),I&4294967295]));I=sjcl.mode.gcm.j(J,[0,0,0,0],M);s=L.slice(0);M=I.slice(0);P||(M=sjcl.mode.gcm.j(J,I,N));for(w=0;w<v;w+=4){s[3]++,x=O.encrypt(s),N[w]^=x[0],N[w+1]^=x[1],N[w+2]^=x[2],N[w+3]^=x[3]}N=j.clamp(N,o);P&&(M=sjcl.mode.gcm.j(J,I,N));P=[Math.floor(i/4294967296),i&4294967295,Math.floor(o/4294967296),o&4294967295];M=sjcl.mode.gcm.j(J,M,P);x=O.encrypt(L);M[0]^=x[0];M[1]^=x[1];M[2]^=x[2];M[3]^=x[3];return{tag:j.bitSlice(M,0,K),data:N}}};sjcl.misc.hmac=function(g,f){this.W=f=f||sjcl.hash.sha256;var j=[[],[]],i,h=f.prototype.blockSize/32;this.w=[new f,new f];g.length>h&&(g=f.hash(g));for(i=0;i<h;i++){j[0][i]=g[i]^909522486,j[1][i]=g[i]^1549556828}this.w[0].update(j[0]);this.w[1].update(j[1]);this.R=new f(this.w[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(b){if(this.aa){throw new sjcl.exception.invalid("encrypt on already updated hmac called!")}this.update(b);return this.digest(b)};sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=!1};sjcl.misc.hmac.prototype.update=function(b){this.aa=!0;this.R.update(b)};sjcl.misc.hmac.prototype.digest=function(){var b=this.R.finalize(),b=(new this.W(this.w[1])).update(b).finalize();this.reset();return b};sjcl.misc.pbkdf2=function(x,w,v,s,r){v=v||10000;if(0>s||0>v){throw new sjcl.exception.invalid("invalid params to pbkdf2")}"string"===typeof x&&(x=sjcl.codec.utf8String.toBits(x));"string"===typeof w&&(w=sjcl.codec.utf8String.toBits(w));r=r||sjcl.misc.hmac;x=new r(x);var q,p,o,m,j=[],i=sjcl.bitArray;for(m=1;32*j.length<(s||1);m++){r=q=x.encrypt(i.concat(w,[m]));for(p=1;p<v;p++){for(q=x.encrypt(q),o=0;o<q.length;o++){r[o]^=q[o]}}j=j.concat(r)}s&&(j=i.clamp(j,s));return j};sjcl.prng=function(b){this.c=[new sjcl.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=b;this.D=!1;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=30000;this.ba=80};sjcl.prng.prototype={randomWords:function(i,h){var n=[],m;m=this.isReady(h);var l;if(m===this.u){throw new sjcl.exception.notReady("generator isn't seeded")}if(m&this.J){m=!(m&this.I);l=[];var k=0,j;this.Z=l[0]=(new Date).valueOf()+this.da;for(j=0;16>j;j++){l.push(4294967296*Math.random()|0)}for(j=0;j<this.c.length&&(l=l.concat(this.c[j].finalize()),k+=this.m[j],this.m[j]=0,m||!(this.P&1<<j));j++){}this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0));this.f-=k;k>this.o&&(this.o=k);this.P++;this.b=sjcl.hash.sha256.hash(this.b.concat(l));this.L=new sjcl.cipher.aes(this.b);for(m=0;4>m&&(this.h[m]=this.h[m]+1|0,!this.h[m]);m++){}}for(m=0;m<i;m+=4){0===(m+1)%this.ca&&y(this),l=z(this),n.push(l[0],l[1],l[2],l[3])}y(this);return n.slice(0,i)},setDefaultParanoia:function(d,c){if(0===d&&"Setting paranoia=0 will ruin your security; use it only for testing"!==c){throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing")}this.M=d},addEntropy:function(r,q,p){p=p||"user";var o,n,m=(new Date).valueOf(),l=this.H[p],j=this.isReady(),i=0;o=this.U[p];void 0===o&&(o=this.U[p]=this.ha++);void 0===l&&(l=this.H[p]=0);this.H[p]=(this.H[p]+1)%this.c.length;switch(typeof r){case"number":void 0===q&&(q=1);this.c[l].update([o,this.N++,1,q,m,1,r|0]);break;case"object":p=Object.prototype.toString.call(r);if("[object Uint32Array]"===p){n=[];for(p=0;p<r.length;p++){n.push(r[p])}r=n}else{for("[object Array]"!==p&&(i=1),p=0;p<r.length&&!i;p++){"number"!==typeof r[p]&&(i=1)}}if(!i){if(void 0===q){for(p=q=0;p<r.length;p++){for(n=r[p];0<n;){q++,n=n>>>1}}}this.c[l].update([o,this.N++,2,q,m,r.length].concat(r))}break;case"string":void 0===q&&(q=r.length);this.c[l].update([o,this.N++,3,q,m,r.length]);this.c[l].update(r);break;default:i=1}if(i){throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")}this.m[l]+=q;this.f+=q;j===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(b){b=this.T[void 0!==b?b:this.M];return this.o&&this.o>=b?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=b?this.J|this.u:this.u},getProgress:function(b){b=this.T[b?b:this.M];return this.o>=b?1:this.f>b?1:this.f/b},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener){window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1)}else{if(document.attachEvent){document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}else{throw new sjcl.exception.bug("can't attach event")}}this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(d,c){this.K[d][this.ga++]=c},removeEventListener:function(h,g){var l,k,j=this.K[h],i=[];for(k in j){j.hasOwnProperty(k)&&j[k]===g&&i.push(k)}for(l=0;l<i.length;l++){k=i[l],delete j[k]}},la:function(){C(this,1)},oa:function(f){var e,h;try{e=f.x||f.clientX||f.offsetX||0,h=f.y||f.clientY||f.offsetY||0}catch(g){h=e=0}0!=e&&0!=h&&this.addEntropy([e,h],2,"mouse");C(this,0)},qa:function(b){b=b.touches[0]||b.changedTouches[0];this.addEntropy([b.pageX||b.clientX,b.pageY||b.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(d){d=d.accelerationIncludingGravity.x||d.accelerationIncludingGravity.y||d.accelerationIncludingGravity.z;if(window.orientation){var c=window.orientation;"number"===typeof c&&this.addEntropy(c,1,"accelerometer")}d&&this.addEntropy(d,2,"accelerometer");C(this,0)}};function A(g,f){var j,i=sjcl.random.K[g],h=[];for(j in i){i.hasOwnProperty(j)&&h.push(i[j])}for(j=0;j<h.length;j++){h[j](f)}}function C(d,c){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?d.addEntropy(window.performance.now(),c,"loadtime"):d.addEntropy((new Date).valueOf(),c,"loadtime")}function y(b){b.b=z(b).concat(z(b));b.L=new sjcl.cipher.aes(b.b)}function z(d){for(var c=0;4>c&&(d.h[c]=d.h[c]+1|0,!d.h[c]);c++){}return d.L.encrypt(d.h)}function B(d,c){return function(){c.apply(d,arguments)}}sjcl.random=new sjcl.prng(6);a:try{var D,E,F,G;if(G="undefined"!==typeof module&&module.exports){var H;try{H=require("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes){D=E.randomBytes(128),D=new Uint32Array((new Uint8Array(D)).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']")}else{if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(F)}else{if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(F)}else{break a}}sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}sjcl.json={defaults:{v:1,iter:10000,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(i,h,n,m){n=n||{};m=m||{};var l=sjcl.json,k=l.g({iv:sjcl.random.randomWords(4,0)},l.defaults),j;l.g(k,n);n=k.adata;"string"===typeof k.salt&&(k.salt=sjcl.codec.base64.toBits(k.salt));"string"===typeof k.iv&&(k.iv=sjcl.codec.base64.toBits(k.iv));if(!sjcl.mode[k.mode]||!sjcl.cipher[k.cipher]||"string"===typeof i&&100>=k.iter||64!==k.ts&&96!==k.ts&&128!==k.ts||128!==k.ks&&192!==k.ks&&256!==k.ks||2>k.iv.length||4<k.iv.length){throw new sjcl.exception.invalid("json encrypt: invalid parameters")}"string"===typeof i?(j=sjcl.misc.cachedPbkdf2(i,k),i=j.key.slice(0,k.ks/32),k.salt=j.salt):sjcl.ecc&&i instanceof sjcl.ecc.elGamal.publicKey&&(j=i.kem(),k.kemtag=j.tag,i=j.key.slice(0,k.ks/32));"string"===typeof h&&(h=sjcl.codec.utf8String.toBits(h));"string"===typeof n&&(k.adata=n=sjcl.codec.utf8String.toBits(n));j=new sjcl.cipher[k.cipher](i);l.g(m,k);m.key=i;k.ct="ccm"===k.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&h instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(j,h,k.iv,n,k.ts):sjcl.mode[k.mode].encrypt(j,h,k.iv,n,k.ts);return k},encrypt:function(h,g,l,k){var j=sjcl.json,i=j.ja.apply(j,arguments);return j.encode(i)},ia:function(i,h,n,m){n=n||{};m=m||{};var l=sjcl.json;h=l.g(l.g(l.g({},l.defaults),h),n,!0);var k,j;k=h.adata;"string"===typeof h.salt&&(h.salt=sjcl.codec.base64.toBits(h.salt));"string"===typeof h.iv&&(h.iv=sjcl.codec.base64.toBits(h.iv));if(!sjcl.mode[h.mode]||!sjcl.cipher[h.cipher]||"string"===typeof i&&100>=h.iter||64!==h.ts&&96!==h.ts&&128!==h.ts||128!==h.ks&&192!==h.ks&&256!==h.ks||!h.iv||2>h.iv.length||4<h.iv.length){throw new sjcl.exception.invalid("json decrypt: invalid parameters")}"string"===typeof i?(j=sjcl.misc.cachedPbkdf2(i,h),i=j.key.slice(0,h.ks/32),h.salt=j.salt):sjcl.ecc&&i instanceof sjcl.ecc.elGamal.secretKey&&(i=i.unkem(sjcl.codec.base64.toBits(h.kemtag)).slice(0,h.ks/32));"string"===typeof k&&(k=sjcl.codec.utf8String.toBits(k));j=new sjcl.cipher[h.cipher](i);k="ccm"===h.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&h.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(j,h.ct,h.iv,h.tag,k,h.ts):sjcl.mode[h.mode].decrypt(j,h.ct,h.iv,k,h.ts);l.g(m,h);m.key=i;return 1===n.raw?k:sjcl.codec.utf8String.fromBits(k)},decrypt:function(g,f,j,i){var h=sjcl.json;return h.ia(g,h.decode(f),j,i)},encode:function(f){var e,h="{",g="";for(e in f){if(f.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i)){throw new sjcl.exception.invalid("json encode: invalid property name")}h+=g+'"'+e+'":';g=",";switch(typeof f[e]){case"number":case"boolean":h+=f[e];break;case"string":h+='"'+escape(f[e])+'"';break;case"object":h+='"'+sjcl.codec.base64.fromBits(f[e],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}}return h+"}"},decode:function(f){f=f.replace(/\s/g,"");if(!f.match(/^\{.*\}$/)){throw new sjcl.exception.invalid("json decode: this isn't json!")}f=f.replace(/^\{|\}$/g,"").split(/,/);var e={},h,g;for(h=0;h<f.length;h++){if(!(g=f[h].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))){throw new sjcl.exception.invalid("json decode: this isn't json!")}null!=g[3]?e[g[2]]=parseInt(g[3],10):null!=g[4]?e[g[2]]=g[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(g[4]):unescape(g[4]):null!=g[5]&&(e[g[2]]="true"===g[5])}return e},g:function(f,e,h){void 0===f&&(f={});if(void 0===e){return f}for(var g in e){if(e.hasOwnProperty(g)){if(h&&void 0!==f[g]&&f[g]!==e[g]){throw new sjcl.exception.invalid("required parameter overridden")}f[g]=e[g]}}return f},sa:function(f,e){var h={},g;for(g in f){f.hasOwnProperty(g)&&f[g]!==e[g]&&(h[g]=f[g])}return h},ra:function(f,e){var h={},g;for(g=0;g<e.length;g++){void 0!==f[e[g]]&&(h[e[g]]=f[e[g]])}return h}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.pa={};sjcl.misc.cachedPbkdf2=function(f,e){var h=sjcl.misc.pa,g;e=e||{};g=e.iter||1000;h=h[f]=h[f]||{};g=h[g]=h[g]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)};h=void 0===e.salt?g.firstSalt:e.salt;g[h]=g[h]||sjcl.misc.pbkdf2(f,h,e.iter);return{key:g[h].slice(0),salt:h.slice(0)}};"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);"function"===typeof define&&define([],function(){return sjcl});