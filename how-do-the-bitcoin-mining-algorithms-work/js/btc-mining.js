var passColor="#7db904";var failColor="red";var stopHashingForm={};var difficultyChars={};var difficultyAttempts={};var txsPerBlock=[];var miningData={versionRaw:null,versionInt:null,version:null,prevHashRaw:null,prevHash:null,merkleRootRaw:null,merkleRoot:null,timestampRaw:null,timestampUnixtime:null,timestamp:null,bitsRaw:null,bits:null,nonceRaw:null,nonceInt:null,nonce:null,target:null};var permanently=true;var keyCodeENTER=13;addEvent(window,"load",function(){initBorderTheDigits();addEvent(document.querySelectorAll("button.wrap-nowrap"),"click",function(d){d.preventDefault();runHashWrapClicked(d);return false});addEvent(document.getElementById("btnRunHash0"),"click",function(d){d.preventDefault();runHash0Clicked();return false});addEvent(document.getElementById("inputMessage0"),"keyup",function(d){d.preventDefault();if(d.keyCode!=keyCodeENTER){return}runHash0Clicked(d);return false});removeGlassCase("form0",permanently);addEvent(document.querySelector("#dec2hexTable .instructions"),"click",function(d){d.preventDefault();showMoreDec2Hex();return false});var a={firstTime:true,hashMatch:document.getElementById("match1").textContent,matchFound:false,previousNonce:"",formNum:1,hashRateData:[],checkboxPurpose:"increment preimage",prefix:""};stopHashingForm[1]=false;difficultyChars[1]=64;addEvent(document.getElementById("btnRunHash1"),"click",function(d){d.preventDefault();runHash1Or2Or3Clicked(a);return false});addEvent(document.getElementById("inputMessage1"),"keyup",function(d){d.preventDefault();if(d.keyCode!=keyCodeENTER){return}runHash1Or2Or3Clicked(a);return false});removeGlassCase("form1",permanently);var b={firstTime:true,hashMatch:document.getElementById("match2").textContent,matchFound:false,previousNonce:"",formNum:2,state:"stopped",hashRateData:[],checkboxPurpose:"increment preimage",prefix:""};stopHashingForm[2]=false;difficultyChars[2]=64;addEvent(document.getElementById("btnRunHash2"),"click",function(d){d.preventDefault();runHash2Clicked(d,b);return false});removeGlassCase("form2",permanently);var c={firstTime:true,hashMatch:document.getElementById("match3").textContent,matchFound:false,previousNonce:"",formNum:3,state:"stopped",hashRateData:[],checkboxPurpose:"mine automatically",attempts:{},prefix:initProofOfWorkForm()};initDifficultyLevelDropdown(3);addEvent(document.getElementById("btnRunHash3"),"click",function(d){d.preventDefault();runHash3Clicked(d,c);return false});difficultyChars[3]=1;addEvent(document.getElementById("difficulty3"),"change",function(d){d.preventDefault();difficulty3Changed(d);return false});addEvent(document.getElementById("inputCheckbox3"),"click",function(d){checkbox3Changed(d);return false});removeGlassCase("form3",permanently);initBlockchainSVG();addEvent(document.getElementById("version4"),"keyup, change",function(d){d.preventDefault();version4Changed(d);return false});triggerEvent(document.getElementById("version4"),"change");addEvent(document.getElementById("prevHash4"),"keyup, change",function(d){d.preventDefault();prevHash4Changed(d);return false});triggerEvent(document.getElementById("prevHash4"),"change");addEvent(document.getElementById("merkleRoot4"),"keyup, change",function(d){d.preventDefault();merkleRoot4Changed(d);return false});triggerEvent(document.getElementById("merkleRoot4"),"change");addEvent(document.getElementById("timestamp4"),"keyup, change",function(d){d.preventDefault();timestamp4Changed(d);return false});triggerEvent(document.getElementById("timestamp4"),"change");addEvent(document.getElementById("bits4"),"keyup, change",function(d){d.preventDefault();bits4Changed(d);return false});triggerEvent(document.getElementById("bits4"),"change");addEvent(document.getElementById("nonce4"),"keyup, change",function(d){d.preventDefault();nonce4Changed(d);return false});triggerEvent(document.getElementById("nonce4"),"change");addEvent(document.getElementById("btnRunHash4"),"click",function(d){d.preventDefault();mine4AndRenderResults(d);return false});addEvent(document.getElementById("makeBlockPass4"),"click",function(d){d.preventDefault();scrollToElement(document.getElementById("form4"));resetBlock4(true);return false});removeGlassCase("form4",permanently);addEvent(document.getElementById("version5"),"keyup, change",function(d){d.preventDefault();version5Changed(d);return false});triggerEvent(document.getElementById("version5"),"change");removeGlassCase("form5",permanently);addEvent(document.getElementById("timestamp6"),"keyup, change",function(d){d.preventDefault();timestamp6Changed(d);return false});triggerEvent(document.getElementById("timestamp6"),"change");removeGlassCase("form6",permanently);addEvent(document.getElementById("difficulty7"),"keyup, change",function(d){d.preventDefault();difficulty7Changed(d);return false});addEvent(document.getElementById("bits7"),"keyup, change",function(d){d.preventDefault();bits7Changed(d);return false});addEvent(document.getElementById("bitsAreHex7"),"click",function(d){bitsAreHex7Changed(d);return false});addEvent(document.getElementById("target7"),"keyup, change",function(d){d.preventDefault();target7Changed(d);return false});triggerEvent(document.getElementById("bits7"),"change");addEvent(document.getElementById("runDifficultyUnitTests"),"click",function(d){d.preventDefault();runDifficultyUnitTests(d);return false});removeGlassCase("form7",permanently);addEvent(document.getElementById("nonce8"),"keyup, change",function(d){d.preventDefault();nonce8Changed(d);return false});triggerEvent(document.getElementById("nonce8"),"change");removeGlassCase("form8",permanently);addEvent(document.getElementById("version9"),"keyup, change",function(d){d.preventDefault();version9Changed(d);return false});triggerEvent(document.getElementById("version9"),"change");addEvent(document.getElementById("prevHash9"),"keyup, change",function(d){d.preventDefault();prevHash9Changed(d);return false});triggerEvent(document.getElementById("prevHash9"),"change");addEvent(document.getElementById("merkleRoot9"),"keyup, change",function(d){d.preventDefault();merkleRoot9Changed(d);return false});triggerEvent(document.getElementById("merkleRoot9"),"change");addEvent(document.getElementById("timestamp9"),"keyup, change",function(d){d.preventDefault();timestamp9Changed(d);return false});triggerEvent(document.getElementById("timestamp9"),"change");addEvent(document.getElementById("bits9"),"keyup, change",function(d){d.preventDefault();bits9Changed(d);return false});triggerEvent(document.getElementById("bits9"),"change");addEvent(document.getElementById("nonce9"),"keyup, change",function(d){d.preventDefault();nonce9Changed(d);return false});triggerEvent(document.getElementById("nonce9"),"change");removeGlassCase("form9",permanently);addEvent(document.getElementById("inputMessage10"),"keyup, change",function(d){d.preventDefault();runHash10Changed(d);return false});triggerEvent(document.getElementById("inputMessage10"),"change");addEvent(document.getElementById("inputCheckbox10"),"click",function(d){runHash10Changed(d);return false});removeGlassCase("form10",permanently);initDifficultyLevelDropdown(11);addEvent(document.getElementById("difficulty11"),"change",function(d){d.preventDefault();difficulty11Changed(d);return false});initDifficultyAttempts();switch(getDeviceType()){case"phone":toggleAllCodeblockWrapsMobile();break;case"tablet":case"pc":break}});function initBorderTheDigits(){var a=document.querySelectorAll(".individual-digits");foreach(a,function(b,c){borderTheDigits(c,new Array(c.textContent.length))})}function runHashWrapClicked(d){var b=d.currentTarget;var c=b.closest(".codeblock-container").querySelector(".codeblock");var a=(b.getAttribute("wrapped")=="true");fixCodeblockNewlines(c,a)}function fixCodeblockNewlines(b,a){if(a){b.innerHTML=b.innerHTML.replace(/\n\n/g,"\n").replace(/\n/g,"\n\n");foreach(b.querySelectorAll(".preserve-newline"),function(c,d){d.innerHTML=""})}else{b.innerHTML=b.innerHTML.replace(/\n\n/g,"\n");foreach(b.querySelectorAll(".preserve-newline"),function(c,d){d.innerHTML="\n"})}foreach(b.querySelectorAll(".always-one-newline"),function(c,d){if(a&&getDeviceType()=="phone"){d.style.display="none"}else{d.innerHTML="\n";d.style.display="inline"}})}function runHash0Clicked(){var j=document.getElementById("form0");var k=document.getElementById("inputMessage0").value;var a=new Date();var d=sjcl.hash.sha256.hash(k);var c=sjcl.codec.hex.fromBits(d);var h=new Date();var e=h-a;var g="(hashing took ";var b="(took ";if(e<1){g+="less than 1";b+="<1"}else{g+=e;b+=e}g+=" millisecond"+(e<=1?"":"s")+")";b+="ms)";document.getElementById("hash0Duration").innerHTML=g;var i=(j.querySelector("button.wrap-nowrap").getAttribute("wrapped")=="true");var f=document.getElementById("hash0Results");f.innerHTML=(k+' <span class="aligner"></span>-> SHA256 -> '+c+" "+b+"\n"+(i?"\n":"")+f.innerHTML).trim();if(!i){alignText(f)}f.closest(".codeblock-container").style.display="block"}var latestDec=19;function showMoreDec2Hex(){var d=document.getElementById("dec2hexData");var a=d.innerHTML;var b=latestDec+15;for(;latestDec<=b;latestDec++){a+="<tr><td>"+latestDec+"</td><td>"+int2hex(latestDec)+"</td></tr>"}try{d.innerHTML=a}catch(c){d.outerHTML='<table id="dec2hexData">'+a+"</table>"}var e=document.querySelector("#dec2hexTable .vertical-scroll");e.scrollTop=e.scrollHeight}function runHash2Clicked(b,c){switch(c.state){case"running":stopHashingForm[2]=true;c.state="stopped";b.currentTarget.innerHTML="Run SHA256 Automatically";renderHashing2Duration(c.hashRateData);break;case"stopped":stopHashingForm[2]=false;c.state="running";b.currentTarget.innerHTML="Stop";(function a(d){if(stopHashingForm[2]){return}runHash1Or2Or3Clicked(d);setTimeout(function(){a(d)},0)})(c);break}}function renderHashing2Duration(c){var b=getAverageHashRate(c,true);if(b<1){return}document.querySelectorAll(".hash2Rate")[0].innerHTML=b;document.querySelectorAll(".hash2Rate")[1].innerHTML=b;document.getElementById("showHowLongForThisDevice").style.display="inline";var a=addThousandCommas(Math.round(3671743063/b));document.getElementById("howLongForThisDeviceWords").innerHTML=a+" million".repeat(10)+" years";document.getElementById("howLongForThisDeviceNumber").innerHTML=a+",000".repeat(20)+" years"}function initDifficultyLevelDropdown(b){var c='<option value="1">match first character only</option>\n';for(var a=2;a<64;a++){c+='<option value="'+a+'">match first '+a+" characters only</option>\n"}c+='<option value="64">match all 64 characters</option>\n';document.getElementById("difficulty"+b).outerHTML='<select id="difficulty'+b+'">'+c+"</select>"}function initProofOfWorkForm(){var a=getRandomAlpha(10);document.getElementById("inputMessage3Prefix").value=a;return a}function difficulty3Changed(a){difficultyChars[3]=parseInt(a.currentTarget.value);document.getElementById("btnRunHash3").disabled=false}function checkbox3Changed(a){document.getElementById("btnRunHash3").innerHTML="Mine "+(a.currentTarget.checked?"automatically":"manually")+" with SHA256"}function runHash3Clicked(d,f){var c=document.getElementById("inputCheckbox3").checked;var b="Mine "+(c?"automatically":"manually")+" with SHA256";switch(f.state){case"running":stopHashingForm[3]=true;f.state="stopped";d.currentTarget.innerHTML=b;document.getElementById("difficulty3").disabled=false;document.getElementById("inputCheckbox3").disabled=false;break;case"stopped":stopHashingForm[3]=false;f.state="running";if(c){d.currentTarget.innerHTML="Stop";document.getElementById("difficulty3").disabled=true;document.getElementById("inputCheckbox3").disabled=true}if(!f.attempts.hasOwnProperty(difficultyChars[3])){f.attempts[difficultyChars[3]]=0;f.attempts["matchFound"+difficultyChars[3]]=false}(function a(i){if(stopHashingForm[3]){return}runHash1Or2Or3Clicked(i);i.attempts[difficultyChars[3]]++;if(i.matchFound){stopHashingForm[3]=true;i.state="stopped";i.attempts["matchFound"+difficultyChars[3]]=true;var h=document.getElementById("btnRunHash3");h.disabled=true;h.innerHTML=b;document.getElementById("difficulty3").getElementsByTagName("option")[difficultyChars[3]-1].disabled=true;document.getElementById("difficulty3").disabled=false;document.getElementById("inputCheckbox3").disabled=false}else{if(!c){i.state="stopped"}}var g='\n<span class="preserve-newline">\n</span>';for(var k=1;k<=64;k++){if(!i.attempts.hasOwnProperty(k)){continue}var m=i.attempts[k];var n=" not yet mined after ";if(i.attempts["matchFound"+k]){n=" mined in "}if(!i.attempts.hasOwnProperty("luck"+k)){i.attempts["luck"+k]=""}if(i.attempts["matchFound"+k]&&(i.attempts["luck"+k]=="")){var j=Math.floor(Math.pow(16,k)/4);var l=3*j;var e=" (";if(m<j){e+="very lucky"}else{if(m>l){e+="very unlucky"}else{if(m<(j*2)){e+="a bit lucky"}else{if(m>(j*2)){e+="a bit unlucky"}else{e+="pretty standard"}}}}e+=" - the average is "+(j*2)+" attempts)";i.attempts["luck"+k]=e}g+=k+" digit"+plural("s",k>1)+n+m+" attempt"+plural("s",m>1)+i.attempts["luck"+k]+(getDeviceType()=="phone"?"\n\n":"\n")}document.getElementById("mining3Statistics").innerHTML=trimRight(g);if(c){setTimeout(function(){a(i)},0)}})(f);break}}function runHashWrap3Clicked(a){runHashWrapClicked(a);var b=document.getElementById("mining3Statistics");b.innerHTML="\n\n"+b.textContent.trim()}function runHash1Or2Or3Clicked(a){if(stopHashingForm[a.formNum]){return false}if(a.firstTime){document.getElementById("info"+a.formNum).style.display="inline-block";document.getElementById("showResults"+a.formNum).style.display="inline";a.firstTime=false}var h=document.getElementById("inputMessage"+a.formNum).value;var k=false;var l=document.getElementById("inputCheckbox"+a.formNum);if(a.matchFound&&(a.previousNonce==h)){if(a.checkboxPurpose=="increment preimage"&&l.checked){k=true}else{return}}document.getElementById("preImage"+a.formNum).innerHTML=a.prefix+h;var c=sjcl.hash.sha256.hash(a.prefix+h);var b=sjcl.codec.hex.fromBits(c);a.hashRateData.push((new Date()).getTime());while(a.hashRateData.length>10){a.hashRateData.shift()}document.getElementById("info"+a.formNum).getElementsByTagName("span")[0].innerHTML=getAverageHashRate(a.hashRateData);a.matchFound=(a.hashMatch.substr(0,difficultyChars[a.formNum])==b.substr(0,difficultyChars[a.formNum]));if(a.matchFound&&!k&&a.checkboxPurpose=="increment preimage"){l.checked=false}document.getElementById("hash"+a.formNum+"Result").innerHTML=b;var j=(document.getElementById("form"+a.formNum).querySelector("button.wrap-nowrap").getAttribute("wrapped")=="true");var f=(a.checkboxPurpose=="mine automatically"||l.checked);var i=h;if(f){h=incrementAlpha(h)}document.getElementById("inputMessage"+a.formNum).value=h;if(!j&&(a.previousNonce.length!=h.length)){alignText(document.getElementById("codeblock"+a.formNum+"HashResults"))}var g=alphaInCommon(a.hashMatch,b);g=matchResolution(g,difficultyChars[a.formNum]);borderTheDigits("#codeblock"+a.formNum+"HashResults .individual-digits",g);var e=countMatches(g);var d=(a.matchFound?"pass":"fail")+" (because ";if(a.matchFound){d+="the required digits"}else{if(e==0){d+="0"}else{if(e>0){d+="only "+e}}d+=" of "+difficultyChars[a.formNum]+" digits"}d+=" match)";document.getElementById("matchStatus"+a.formNum).innerHTML=d;document.getElementById("matchStatus"+a.formNum).style.color=(a.matchFound?passColor:failColor);a.previousNonce=i;return true}function getAverageHashRate(e,c){var b=0;for(var a=1;a<e.length;a++){b+=(e[a]-e[a-1])}var d=0;if(b==0){d=0}else{d=Math.round((1000*(e.length-1))/b)}if(d<1&&(c!=true)){d="less than 1"}return d}function matchResolution(b,a){foreach(b,function(c){if(c<a){return}b[c]=null});return b}var alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_-+=.'";var lastAlphabetChar=alphabet.substr(-1);function incrementAlpha(b){if(b.length==0){return alphabet[0]}var a=b.substr(-1);if(a==lastAlphabetChar){return incrementAlpha(b.substr(0,b.length-1))+alphabet[0]}else{return b.substr(0,b.length-1)+alphabet[alphabet.indexOf(a)+1]}}function getRandomAlpha(c){var b="";for(var a=0;a<c;a++){b+=alphabet[Math.round((alphabet.length-1)*Math.random())]}return b}function alphaInCommon(c,b){var d=[];for(var a=0;a<c.length;a++){d[a]=((c[a]===b[a])&&(c[a]!=null))}return d}function countMatches(b){var a=0;foreach(b,function(c,d){if(d===true){a++}});return a}function borderTheDigits(d,c,b){b=(b==true);var a=!b;if(typeof d=="string"){d=document.querySelectorAll(d)}else{if(d.length==null){d=[d]}}foreach(d,function(e,f){var g=f.textContent;var h="";foreach(c,function(k){var i="";var j="";switch(c[k]){case true:i="border:1px solid "+passColor+";";break;case false:i="border:1px solid "+failColor+";";break}switch(c[k-1]){case true:if((c[k]!=null)&&b){break}j="border-left:1px solid "+passColor+";";break;case false:if((c[k]!=null)&&a){break}j="border-left:1px solid "+failColor+";";break}h+='<span class="individual-digit" style="'+i+j+'">'+g[k]+"</span>"});f.innerHTML=h})}function borderTheChars(a,d){var c=new RegExp(".{"+d+"}","g");var f=a.match(c);var b='<span class="individual-digit">';var e="</span>";return b+f.join(e+b)+e}function addError(c,b,a){addLi2Ul("#form"+c+" .error",null,a,b+"Error")}function noOtherErrors4(){return(document.querySelectorAll("#form4 ul.error li").length==0)}function versionChanged(e,c){var b={status:true,versionInt:null,version:null};deleteElements(document.querySelectorAll("#form"+c+" .versionError"));function d(f){addError(c,"version",f)}if(!stringIsInt(e)){d("the version must be an integer");b.status=false;return b}var a=parseInt(e);if(a<0){d("the version must be greater than 0");b.status=false;return b}if(a>4294967295){d("the version must be lower than "+4294967295);b.status=false;return b}b.versionInt=a;b.version=toLittleEndian(int2hex(a,8));return b}function version4Changed(c){var b=trimInputValue(c.currentTarget);if(b==miningData.versionRaw){return}var a=versionChanged(b,4);resetMiningStatus();if(!a.status){setButtons(false,"RunHash4");miningData.versionRaw=b;return}miningData.version=a.version;if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.versionRaw=b}function prevHashChanged(a,c){var b={status:true,prevHash:null};deleteElements(document.querySelectorAll("#form"+c+" .prevHashError"));function d(e){addError(c,"prevHash",e)}if(!isHex(a)){d("the previous block hash must only contain hexadecimal digits");b.status=false;return b}if(a.length!=64){d("the previous block hash must be 32 bytes long");b.status=false;return b}b.prevHash=toLittleEndian(a);return b}function prevHash4Changed(c){var b=trimInputValue(c.currentTarget);if(b==miningData.prevHashRaw){return}var a=prevHashChanged(b,4);resetMiningStatus();if(!a.status){setButtons(false,"RunHash4");miningData.prevHashRaw=b;return}miningData.prevHash=a.prevHash;if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.prevHashRaw=b}function merkleRootChanged(a,c){var b={status:true,merkleRoot:null};deleteElements(document.querySelectorAll("#form"+c+" .merkleRootError"));function d(e){addError(c,"merkleRoot",e)}if(!isHex(a)){d("the merkle root must only contain hexadecimal digits");b.status=false;return b}if(a.length!=64){d("the merkle root must be 32 bytes long");b.status=false;return b}b.merkleRoot=toLittleEndian(a);return b}function merkleRoot4Changed(c){var a=trimInputValue(c.currentTarget);if(a==miningData.merkleRootRaw){return}var b=merkleRootChanged(a,4);resetMiningStatus();if(!b.status){setButtons(false,"RunHash4");miningData.merkleRootRaw=a;return}miningData.merkleRoot=b.merkleRoot;if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.merkleRootRaw=a}function timestampChanged(e,c){var b={status:true,timestampUnixtime:null,timestamp:null};deleteElements(document.querySelectorAll("#form"+c+" .timestampError"));function d(f){addError(c,"timestamp",f)}var a;if(stringIsInt(Date.parse(e))){var a=unixtime(e);document.getElementById("timestamp"+c+"Explanation").innerHTML=""}else{if(stringIsInt(e)){var a=parseInt(e);document.getElementById("timestamp"+c+"Explanation").innerHTML=" (unixtime)"}else{d("the timestamp must either be a valid date-time, or be an integer (unixtime)");b.status=false;return b}}if(a<1231006505){d("the timestamp cannot come before 03 Jan 2009, 18:15:05 (GMT)");b.status=false;return b}if(a>4294967295){d("the timestamp cannot come after 07 Feb 2106, 06:28:15 (GMT)");b.status=false;return b}b.timestampUnixtime=a;b.timestamp=toLittleEndian(int2hex(b.timestampUnixtime,8));return b}function timestamp4Changed(c){var a=c.currentTarget.value;if(a==miningData.timestampRaw){return}var b=timestampChanged(a,4);resetMiningStatus();if(!b.status){setButtons(false,"RunHash4");miningData.timestampRaw=a;return}miningData.timestamp=b.timestamp;if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.timestampRaw=a}function bitsChanged(a,c,f){var e={status:true,bits:null,bitsDec:null,bitsBE:null,target:null};deleteElements(document.querySelectorAll("#form"+f+" .bitsError"));function g(h){addError(f,"bits",h)}var b="bits";if(!c){a=a.toString();if(inArray(".",a)){g("when bits is base 10 it cannot contain decimal places");e.status=false;return e}a=a.replace(/,/g,"");if(!stringIsInt(a)){g("when bits is not hex, it can only contain numbers 0 to 9");e.status=false;return e}e.bitsDec=parseInt(a);a=int2hex(e.bitsDec);b="hex bits (derived from base 10 bits)"}var d=bits2target(a);if(d.status==false){g(d.statusMessage.replace("bits",b));e.status=false;return e}e.target=d.target;e.bitsBE=a;e.bits=toLittleEndian(a);if(e.bitsDec==null){e.bitsDec=hex2int(a)}return e}function bits4Changed(d){var b=trimInputValue(d.currentTarget);if(b==miningData.bitsRaw){return}var a=true;var c=bitsChanged(b,a,4);resetMiningStatus();if(!c.status){setButtons(false,"RunHash4");miningData.bitsRaw=b;return}miningData.bits=c.bits;miningData.target=c.target;document.getElementById("target4").innerHTML=miningData.target;borderTheDigits("#target4",new Array(64));if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.bitsRaw=b}function targetChanged(d,c){var b={status:true,target:null};deleteElements(document.querySelectorAll("#form"+c+" .targetError"));function e(f){addError(c,"target",f)}if(!isHex(d)){e("the target must only contain hexadecimal digits");b.status=false;return b}var a=target2bits(d);if(a.status==false){e(a.statusMessage);b.status=false;return b}b.target=d;return b}function difficultyChanged(a,d){var c={status:true,difficulty:null};deleteElements(document.querySelectorAll("#form"+d+" .difficultyError"));function e(g){addError(d,"difficulty",g)}a=a.replace(/,/g,"");var b=difficulty2bits(a);if(b.status==false){e(b.statusMessage);c.status=false;return c}var f=parseFloat(a);c.difficulty=f;return c}function nonceChanged(a,d){var c={status:true,nonce:null,nonceInt:null};deleteElements(document.querySelectorAll("#form"+d+" .nonceError"));function e(f){addError(d,"nonce",f)}if(!stringIsInt(a)){e("the nonce must be an integer");c.status=false;return c}var b=parseInt(a);if(b<0){e("the nonce must be greater than 0");c.status=false;return c}if(b>4294967295){e("the nonce must be lower than "+4294967295);c.status=false;return c}c.nonceInt=b;c.nonce=toLittleEndian(int2hex(b,8));return c}function nonce4Changed(c){var a=trimInputValue(c.currentTarget);if(a==miningData.nonceRaw){return}var b=nonceChanged(a,4);resetMiningStatus();if(!b.status){setButtons(false,"RunHash4");miningData.nonceRaw=a;return}miningData.nonceInt=b.nonceInt;miningData.nonce=b.nonce;if(noOtherErrors4()){setButtons(true,"RunHash4")}miningData.nonceRaw=a}function resetBlock4(a){document.getElementById("version4").value=1;triggerEvent(document.getElementById("version4"),"change");document.getElementById("prevHash4").value="0000000000000000000000000000000000000000000000000000000000000000";triggerEvent(document.getElementById("prevHash4"),"change");document.getElementById("merkleRoot4").value="4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b";triggerEvent(document.getElementById("merkleRoot4"),"change");document.getElementById("timestamp4").value="03 Jan 2009 18:15:05 GMT";triggerEvent(document.getElementById("timestamp4"),"change");document.getElementById("bits4").value="1d00ffff";triggerEvent(document.getElementById("bits4"),"change");document.getElementById("nonce4").value=a?2083236893:0;triggerEvent(document.getElementById("nonce4"),"change")}function resetMiningStatus(){document.getElementById("blockhash4").innerHTML="";document.getElementById("mineStatus4").innerHTML="";borderTheDigits("#target4",new Array(64))}function mine4AndRenderResults(){document.getElementById("nonce4Results").innerHTML=miningData.nonceInt;var a=mine();document.getElementById("blockhash4").innerHTML=a.blockhash;borderTheDigits("#form4 .codeblock .individual-digits",a.matches,true);if(a.status){popup("success!","you mined a block",3000);setButtons(false,"RunHash4");document.getElementById("mineStatus4").innerHTML="pass (because "+a.blockhash[a.resolution]+" is less than "+miningData.target[a.resolution]+")";document.getElementById("mineStatus4").style.color=passColor}else{document.getElementById("mineStatus4").innerHTML="fail (because "+a.blockhash[a.resolution]+" is greater than "+miningData.target[a.resolution]+")";document.getElementById("mineStatus4").style.color=failColor}miningData.nonceInt+=1;if(miningData.nonceInt>4294967295){miningData.nonceInt=0}document.getElementById("nonce4").value=miningData.nonceInt;miningData.nonceRaw=miningData.nonceInt;miningData.nonce=toLittleEndian(int2hex(miningData.nonceInt,8))}function mine(){var d=sjcl.codec.hex.toBits(miningData.version+miningData.prevHash+miningData.merkleRoot+miningData.timestamp+miningData.bits+miningData.nonce);var b=sjcl.hash.sha256.hash(sjcl.hash.sha256.hash(d));var e=toLittleEndian(sjcl.codec.hex.fromBits(b));var f=hexCompare(e,miningData.target,true);var c=[];for(var a=0;a<64;a++){if(a<f.resolution){c.push(true)}else{if(a==f.resolution){if(f.status){c.push(true)}else{c.push(false)}}else{c.push(null)}}}return{blockhash:e,status:f.status,resolution:f.resolution,matches:c}}function setCompact(i,d){var g={status:false,target:null,isNegative:null,isOverflow:null,statusMessage:"",steps:[]};if(i.length!=8){g.statusMessage="bits must be 4 bytes long";return g}if(!isHex(i)){g.statusMessage="bits must only contain hexadecimal digits";return g}if(d>=1){g.steps.push({left:"in the Bitcoin source code this conversion uses function setCompact(). 'bits' here is made up of 1 'size' byte followed by 3 'compact' bytes",right:null})}g.target="";var a=i;i=hex2int(i);if(d>=2){g.steps.push({left:"bits",right:"0x"+borderTheChars(a,2)+" = "+i})}var n=i>>>24;var j=int2hex(n,2);if(d>=2){g.steps.push({left:"extract the 'size' byte",right:"0x"+a+" >> 24 = 0x"+j+" = "+n})}var b=i&8388607;var k=int2hex(b,8);if(d>=2){g.steps.push({left:"extract the 3 'word' bytes",right:"0x"+a+" & 0x007fffff = 0x"+k+" = "+b})}if(n<=3){var m=8*(3-n);b>>=m;if(d>=2){g.steps.push({left:"the size is <= 3, so shift the mantissa right by  8 * (3 - size) = "+m+" bits to get",right:b})}g.target=int2hex(b,64);if(d>=2){g.steps.push({left:"convert the mantissa to 32 bytes to get the target value",right:"0x"+g.target})}}else{g.target=leftPad(int2hex(b)+"00".repeat(n-3),64).substr(-64);if(d>=2){g.steps.push({left:"the 'size' is > 3 so shift the 'word' left by 8 * (size - 3) = "+(8*(n-3))+" bits and convert to 32 bytes to get the target value",right:"0x"+g.target})}}g.isNegative=(b!=0)&&((i&8388608)!=0);if(d>=2){var c=g.isNegative?"":" not";var l=g.isNegative?"negative":"positive";g.steps.push({left:"the target is "+l+" because the 0x00800000 bit is"+c+" set in the original bits value",right:null});g.steps.push({left:"negative status",right:l})}var h=(n>34);var f=(b>255)&&(n>33);var e=(b>65535)&&(n>32);if(b==0){g.isOverflow=false;if(d>=2){g.steps.push({left:"the target is zero. overflow status",right:"false"})}}else{if(h){g.isOverflow=true;if(d>=2){g.steps.push({left:"the 'size' is greater than 34. overflow status",right:"true"})}}else{if(f){g.isOverflow=true;if(d>=2){g.steps.push({left:"the 'size' is greater than 33 and the mantissa ("+b+") is greater than 0xff. overflow status",right:"true"})}}else{if(e){g.isOverflow=true;if(d>=2){g.steps.push({left:"the 'size' is greater than 32 and the mantissa ("+b+") is greater than 0xffff. overflow status",right:"true"})}}else{g.isOverflow=false;if(d>=2){g.steps.push({left:"overflow status",right:"false"})}}}}}g.status=true;return g}function bits2target(c,a){if(a==null){a=0}var b=setCompact(c,a);if(a>=1){b.steps.unshift({left:"<u>bits -> target</u>",right:null})}if(b.isNegative){b.target="-"+b.target}return b}var diffCalcMaxBody=Math.log(65535);var diffCalcScaland=Math.log(256);function bits2difficultyWiki(b){var a=(typeof b=="number")?b:hex2int(b);return Math.exp(diffCalcMaxBody-Math.log(a&16777215)+(diffCalcScaland*(29-((a&4278190080)>>>24))))}function bits2difficulty(g,b){if(b==null){b=0}var d={status:false,statusMessage:"",difficulty:null,steps:[]};if(b>=1){d.steps.push({left:"<u>bits -> difficulty</u>",right:null});d.steps.push({left:"in the Bitcoin source code this conversion uses function getDifficulty()",right:null})}if(typeof g=="number"){var e=g;if(e>4294967295){d.statusMessage="bits value must be 4 bytes";return d}}else{if(g.length!=8){d.statusMessage="bits value must be 4 bytes";return d}var e=hex2int(g);if(b>=2){d.steps.push({left:"bits",right:"0x"+borderTheChars(g,2)+" = "+e})}}var a=(e>>>24)&255;var f=int2hex(a,2);if(b>=2){d.steps.push({left:"extract the first byte (called the 'shift' value here)",right:"(0x"+g+" >> 24) & 0xff = 0x"+f+" = "+a})}d.difficulty=parseFloat(65535)/parseFloat(e&16777215);if(b>=2){d.steps.push({left:"initialise the difficulty to 0x0000ffff / (bits & 0x00ffffff)",right:"0x0000ffff / (0x"+g+" & 0x00ffffff) = "+d.difficulty})}if((a<29)&&(b>=2)){d.steps.push({left:"begin looping until 'shift' ("+a+") increases to 29",right:null})}while(a<29){var c=d.difficulty;d.difficulty*=256;a++;if(b>=2){d.steps.push({left:"multiply difficulty by 256 to get",right:c+" * 256 = "+d.difficulty});d.steps.push({left:"increment the 'shift' value to",right:a});if(a<29){d.steps.push({left:"continue looping until 'shift' value increases to 29",right:null})}}}if((a>29)&&(b>=2)){d.steps.push({left:"begin looping until 'shift' ("+a+") decreases to 29",right:null})}while(a>29){d.difficulty/=256;a--;if(b>=2){d.steps.push({left:"divide difficulty by 256 to get",right:d.difficulty});d.steps.push({left:"decrement the 'shift' value to",right:a});if(a>29){d.steps.push({left:"continue looping until 'shift' value decreases to 29",right:null})}}}if(b>=1){d.steps.push({left:"the 'shift' value is equal to 29 so we're finished. the final difficulty is",right:d.difficulty})}d.status=true;return d}function bits(g,b){var d={size:null,steps:[]};if(b>=1){d.steps.push({left:"begin finding the target's 'size'",right:null})}var a=8;if(b>=2){d.steps.push({left:"split the target into 8 chunks of 4 bytes",right:"0x"+borderTheChars(g,8)})}if(b>=2){d.steps.push({left:"begin looping through the chunks, starting from chunk 7 - the leftmost chunk",right:null})}for(var h=a-1,e=0;h>=0;h--,e++){var j=g.substr(e*a,a);var f=hex2int(j);if(b>=2){d.steps.push({left:"chunk "+h,right:"0x"+j+" = "+f})}if(f==0){if(b>=2){d.steps.push({left:"the chunk value is 0. "+((h==0)?"exit the loop here.":"skip to next chunk."),right:null})}continue}if(b>=2){d.steps.push({left:"the chunk value is not 0. begin looping through each bit of the chunk, starting from the most significant bit.",right:null})}for(var c=31;c>0;c--){if(f&Math.pow(2,c)){var k=(32*h)+c+1;if(b>=2){d.steps.push({left:"bit "+c+" in chunk "+h+" is set. so the 'size' is the number of bits in the "+h+" chunks to the right (32 bits per chunk), plus the number of bits in this chunk ("+c+") plus 1. size",right:"(32 * "+h+") + "+c+" + 1 = "+k+" bits = 0x"+int2hex(k,2)+" bits"})}else{if(b==1){d.steps.push({left:"calculated the 'size' to be",right:k+" bits = 0x"+int2hex(k,2)+" bits"})}}d.size=k;return d}if(b>=2){d.steps.push({left:"bit "+c+" is not set. skip to the next bit",right:null})}}var k=(32*h)+1;if(b>=2){d.steps.push({left:"just return the number of bits in the chunks",right:"(32 * "+h+") + 1 = "+k+" bits = 0x"+int2hex(k,2)+" bits"})}else{if(b==1){d.steps.push({left:"calculated the 'size' to be",right:k+" bits = 0x"+int2hex(k,2)+" bits"})}}d.size=k;return d}if(b>=1){d.steps.push({left:"calculated the 'size' to be",right:"0 bits = 0x00 bits"})}d.size=0;return d}function getLow64(a){return a.substr(-16)}function getCompact(h,d,c){var e={status:false,finalBitsInt:null,finalBitsHex:null,statusMessage:"",sizeInt:null,steps:[]};if(h.length!=64){e.statusMessage="the target must be 32 bytes";return e}var f=bits(h,c);e.steps=e.steps.concat(f.steps);e.size=Math.floor((f.size+7)/8);if(c>=2){e.steps.push({left:"convert the 'size' from bits to bytes - add 7 and divide by 8",right:"("+f.size+" + 7) / 8 = "+e.size+" = 0x"+int2hex(e.size,2)})}var j=0;h=h.replace(/^0+/,"");if(e.size<=3){var g=leftPad(getLow64(h),8);if(c>=2){e.steps.push({left:"'size' ("+e.size+") is <= 3. initialize 'compact' to the lowest 64 bits of the target",right:"0x"+g+" = "+hex2int(g)})}var a=g+"00".repeat(3-e.size);a=leftPad(a.substr(-8),8);j=hex2int(a);if(c>=2){e.steps.push({left:"'compact' <<= 8 * (3 - size)",right:"0x"+g+" << 8 * (3 - "+e.size+") = 0x"+a+" = "+j})}}else{var i=leftPad(h.substring(0,h.length-(2*(e.size-3))),6);var a=leftPad(getLow64(i),8);j=hex2int(a);if(c>=2){e.steps.push({left:"'size' ("+e.size+") is > 3. initialize 'compact' by extracting 3 bytes from the target - from 3 bytes below 'size' ("+(e.size-3)+") to the 'size' byte ("+e.size+")",right:"0x"+i});e.steps.push({left:"keep only the lowest 64 bits in 'compact'",right:"0x"+a+" = "+j})}}if(j&8388608){var b=j;j>>=8;if(c>=2){e.steps.push({left:"'compact' bit 0x00800000 is set which would make 'bits' negative. so shift 'compact' right by 8 bits",right:"0x"+int2hex(b,8)+" >> 8 = 0x"+int2hex(j,8)})}e.size++;if(c>=2){e.steps.push({left:"and increment the 'size' to",right:e.size+" = 0x"+int2hex(e.size,2)})}}if((j&~8388607)!==0){e.statusMessage="(compact & ~0x007fffff) !== 0, where compact = 0x"+int2hex(j,8);return e}if(e.size>=256){e.statusMessage="size >= 256, where size = "+e.size;return e}j|=(e.size*Math.pow(2,24));if(c>=2){e.steps.push({left:"combine the 'size' and 'compact' to get 'bits'",right:"0x"+int2hex(j,8)+" = "+j})}if((d===true)&&(j&8388607)){j|=8388608;if(c>=2){e.steps.push({left:"the target is negative but the 'bits' did not have the bit at 0x00800000 set, so set it",right:"0x"+int2hex(j,8)+" = "+j})}}e.status=true;e.finalBitsInt=j;e.finalBitsHex=int2hex(j,8);return e}function target2bits(d,b){if(b==null){b=0}var a=false;if(d[0]=="-"){a=true;d=d.substr(1)}var c=getCompact(d,a,b);if(b>=1){c.steps=[{left:"<u>target -> bits</u>",right:null},{left:"in the Bitcoin source code this conversion uses function getCompact(). 'bits' here is made up of 1 'size' byte followed by 3 'compact' bytes",right:null}].concat(c.steps)}return c}function target2difficulty(d,a){if(a==null){a=0}var c=target2bits(d,a);if(!c.status){return c}var b=bits2difficulty(c.finalBitsInt,a);b.steps=c.steps.concat(b.steps);return b}function difficulty2target(a,b){if(b==null){b=0}var c=difficulty2bits(a);if(!c.status){return c}var d=bits2target(c.finalBitsHex,b);d.steps=c.steps.concat(d.steps);return d}function difficulty2bits(e,d){if(d==null){d=0}var f={status:false,finalBitsInt:null,finalBitsHex:null,statusMessage:"",sizeInt:null,steps:[]};if(d>=1){f.steps.push({left:"<u>difficulty -> bits</u>",right:null});f.steps.push({left:"the Bitcoin source code never has a need to do this calculation so the results here may vary from other implementations. 'bits' here is made up of 1 'size' byte followed by 3 'word' bytes.",right:null})}var b=false;if(typeof e=="string"){if(!stringIsFloat(e)){f.statusMessage="the difficulty must be a number in base 10";return f}e=parseFloat(e)}if(e<0){f.statusMessage="difficulty cannot be negative";return f;b=true;e*=-1}if(!isFinite(e)){f.statusMessage="difficulty cannot be infinite";return f}if(d>=2){f.steps.push({left:"begin looping and checking the 'word' value for each incremented 'shift' value. word = (0x00ffff * (0x100 ^ shift)) /  difficulty, where 'difficulty'",right:e})}for(var i=1;true;i++){var a=(65535*Math.pow(256,i))/e;var g=a<1?"":"0x"+int2hex(a,6)+" = ";if(d>=2){f.steps.push({left:"when 'shift' = "+i+", 'word'",right:"(0x00ffff * (0x100 ^ "+i+")) / "+e+" = "+g+a})}if(a>=65535){if(d>=2){f.steps.push({left:"'word' >= 0xffff so exit the loop here. 'shift'",right:i})}break}if(d>=2){f.steps.push({left:"'word' < 0xffff so continue looping",right:null})}}a&=16777215;if(d>=2){f.steps.push({left:"cap 'word' to a maximum of 0xffffff",right:"0x"+int2hex(a,6)+" = "+a})}var j=29-i;if(d>=2){f.steps.push({left:"calculate size = 0x1d - shift",right:"0x1d - "+i+" = 0x"+int2hex(j,2)+" = "+j})}if(a&8388608){var c=a;a>>=8;j++;if(d>=2){f.steps.push({left:"the sign bit (0x800000) is set so shift 'word' right by 8 bits and increase the 'size' by a byte",right:"0x"+int2hex(c,6)+" >> 8 = 0x"+int2hex(a,6)+" = "+a});f.steps.push({left:"new 'size'",right:"0x"+int2hex(j,2)+" = "+j})}}if((a&~8388607)!=0){f.statusMessage="the 'bits' 'word' is out of bounds";return f}if(j>255){f.statusMessage="the 'bits' 'size' is out of bounds";return f}var h=(j<<24)|a;if(d>=2){f.steps.push({left:"combine the 'size' and the 'word' to get 'bits'. bits = (size << 24) | word",right:"(0x"+int2hex(j,2)+" << 24) | 0x"+int2hex(a,6)+" = 0x"+int2hex(h,8)+" = "+h})}if(b&&(h&8388607)){h|=8388608;if(d>=2){f.steps.push({left:"the difficulty is negative but the bits did not have the bit at 0x00800000 set, so set it",right:"0x"+int2hex(h,8)+" = "+h})}}f.sizeInt=j;f.finalBitsInt=h;f.finalBitsHex=int2hex(h,8);f.status=true;return f}function hexCompare(i,h,e){var b=i;var g=h;var c=null;i=i.replace(/^0*/,"");h=h.replace(/^0*/,"");if(e){c=Math.min(b.length-i.length,g.length-h.length)}if(i.length!=h.length){return{status:i.length<h.length,resolution:c}}for(var f=0;f<i.length;f++){var a=i[f];var d=h[f];if(a==d){continue}if(e){c+=f}return{status:hex2int(a)<hex2int(d),resolution:c}}return{status:false,resolution:c}}function hex2int(a){return parseInt(a,16)}function int2hex(b,a){b=Math.trunc(b);var c=b.toString(16);if(a==null){return c}return leftPad(c,a)}function toLittleEndian(a){if(a.length<=2){return a}if(a.length%2==1){a="0"+a}return a.match(/.{2}/g).reverse().join("")}function to15SigDigits(a){return a.toPrecision(15)}function version5Changed(d){var a=trimInputValue(d.currentTarget);var c=versionChanged(a,5);var b=document.querySelector("#form5 .codeblock-container");if(!c.status){b.style.display="none";return}b.style.display="block";document.getElementById("version5Hex").innerHTML=int2hex(c.versionInt);document.getElementById("version5Bytes").innerHTML=borderTheChars(int2hex(c.versionInt,8),2);document.getElementById("version5BytesLE").innerHTML=borderTheChars(c.version,2)}function timestamp6Changed(d){var c=timestampChanged(d.currentTarget.value,6);var b=document.querySelector("#form6 .codeblock-container");if(!c.status){b.style.display="none";return}b.style.display="block";var a=(new Date((c.timestampUnixtime*1000))).toGMTString();document.getElementById("timestamp6GMT").innerHTML=a;document.getElementById("timestamp6Unixtime").innerHTML=c.timestampUnixtime;document.getElementById("timestamp6Bytes").innerHTML=borderTheChars(int2hex(c.timestampUnixtime,8),2);document.getElementById("timestamp6BytesLE").innerHTML=borderTheChars(c.timestamp,2)}function difficulty7Changed(g){var a=trimInputValue(g.currentTarget);var d=difficultyChanged(a,7);var c=null;var b=null;var f=null;renderForm7Codeblock(d.status,d.difficulty,c,b,f)}function target7Changed(g){var f=trimInputValue(g.currentTarget);var d=targetChanged(f,7);var a=null;var c=null;var b=null;renderForm7Codeblock(d.status,a,c,b,d.target)}function bitsAreHex7Changed(d){var a=d.currentTarget.checked;var c=trimInputValue(document.getElementById("bits7"));var b=bitsChanged(c,!a,7);document.getElementById("bits7").value=a?b.bitsBE:b.bitsDec}function bits7Changed(){var d=trimInputValue(document.getElementById("bits7"));var b=document.getElementById("bitsAreHex7").checked;var c=bitsChanged(d,b,7);var a=null;var e=null;renderForm7Codeblock(c.status,a,c.bitsBE,c.bitsDec,e)}var alignedOnce=false;function renderForm7Codeblock(p,h,r,j,k){var f=2;var d='<span class="always-one-newline">\n</span>';var l=document.querySelector("#form7 .codeblock-container");var i=l.querySelector(".codeblock");i.innerHTML="";var a=document.querySelector("#form7 .warnings");a.style.display="none";if(!p){l.style.display="none";return}deleteElements(document.querySelectorAll("#form7 .bitsError"));deleteElements(document.querySelectorAll("#form7 .difficultyError"));deleteElements(document.querySelectorAll("#form7 .targetError"));l.style.display="block";var e=false;var c=document.getElementById("bitsAreHex7").checked;var o=[];if(h!==null){e=true;if(r===null){var b=difficulty2bits(h,f);r=b.finalBitsHex;document.getElementById("bits7").value=c?r:b.finalBitsInt;o=o.concat(b.steps)}if(k===null){var g=difficulty2target(h,f);k=g.target;document.getElementById("target7").value=k;o=o.concat(g.steps)}}else{if(r!==null){if(h===null){var m=bits2difficulty(r,f);h=m.difficulty;document.getElementById("difficulty7").value=h;o=o.concat(m.steps)}if(k===null){var g=bits2target(r,f);k=g.target;document.getElementById("target7").value=k;o=o.concat(g.steps)}}else{if(k!==null){if(r===null){var b=target2bits(k,f);j=b.finalBitsInt;r=int2hex(j,8);document.getElementById("bits7").value=c?r:j;o=o.concat(b.steps)}if(h===null){var m=bits2difficulty(r,f);h=m.difficulty;document.getElementById("difficulty7").value=h;o=o.concat(m.steps)}}}}i.innerHTML=formatCodeblockSteps(o,50);var q=(l.querySelector("button.wrap-nowrap").getAttribute("wrapped")=="true");fixCodeblockNewlines(i,q);if(q){unalignText(i)}else{alignText(i)}}var aligner='<span class="aligner"> </span>';function formatCodeblockSteps(b,a){var c='<span class="preserve-newline">\n</span>\n';var d="";foreach(b,function(e,f){if(f.left=="\n"){d+=(c+c);return}f.left=wrapCodeblockLeft(f.left,a).trim();if(f.right==null){f.right=""}else{f.left+=": "}if(b.length==(e+1)){c=""}d+=f.left+aligner+f.right+c});return d}function wrapCodeblockLeft(d,b){if(d.length<=b){return d}var f='<span class="always-one-newline">\n</span>';var e=d.split(" ");var a=0;var c="";foreach(e,function(g,h){a+=h.length+1;if(a>b){c+=aligner+f+h+" ";a=h.length+1}else{c+=h+" "}});return c}function runDifficultyUnitTests(){document.getElementById("unitTests7").style.display="block";var a=document.querySelector("#unitTests7 .codeblock");ajax(siteGlobals.unittestBitsJSON,function(c){try{var e=JSON.parse(c).tests}catch(d){a.innerHTML="failed to fetch unit-test data"}b(e)});function b(g){a.innerHTML="";var f='<span style="color:'+passColor+'">pass</span>';var c='<span style="color:'+failColor+'">fail</span>';var d='<span class="aligner">';var h="</span>";var k='\n<span class="preserve-newline">\n</span>\n';var j=[];foreach(g,function(y,n){var B=bits2target(n.original_bits);var D=target2bits(B.target);var p=D.finalBitsHex;var v=(n.target==B.target);var s=v?f:c;var z=(n.reconverted_bits==p);var C=z?f:c;var o=(B.isNegative==n.negative);var r=o?f:c;var u=(B.isOverflow==n.overflow);var x=u?f:c;var l=bits2difficulty(n.original_bits);var A=l.difficulty;var m=n.difficulty_threshold_low;var e=n.difficulty_threshold_high;var w=true;if((m=="Infinity"&&A!=Infinity)||(e=="Infinity"&&A!=Infinity)||(A<m)||(A>e)){w=false}var q=w?f:c;var t=(v&&z&&o&&u&&w);if(!t){j.push(y)}var E=((y==0)?"":k)+"<u>test "+y+"</u>: "+(t?f:c)+"\nbits: "+d+"                         "+h+n.original_bits+"\ntarget (expected): "+d+"            "+h+n.target+"\ntarget (derived): "+d+"             "+h+B.target+"\ntarget check: "+d+"                 "+h+s+"\nreconverted bits (expected): "+d+"  "+h+n.reconverted_bits+"\nreconverted bits (derived): "+d+"   "+h+p+"\nreconverted bits check: "+d+"       "+h+C+"\ntarget is negative (expected): "+d+h+(n.negative?"yes":"no")+"\ntarget is negative (derived): "+d+" "+h+(B.isNegative?"yes":"no")+"\ntarget is negative check: "+d+"     "+h+r+"\ntarget overflowed (expected): "+d+" "+h+(B.isOverflow?"yes":"no")+"\ntarget overflowed (derived): "+d+"  "+h+(n.overflow?"yes":"no")+"\ntarget overflow check: "+d+"        "+h+x+"\ndifficulty lower threshold: "+d+"   "+h+m+"\ndifficulty upper threshold: "+d+"   "+h+e+"\ndifficulty (derived): "+d+"         "+h+A+"\ndifficulty check: "+d+"             "+h+q;a.innerHTML=(a.innerHTML+E).trim()});document.getElementById("overallStatus7").style.display="block";document.getElementById("overallStatusPass7").innerHTML=(j.length==0)?f:c+" (due to test"+(j.length>1?"s":"")+" "+englishList(j,", "," and ")+")";var i=(document.querySelector("#unitTests7 button.wrap-nowrap").getAttribute("wrapped")=="true");fixCodeblockNewlines(a,i);if(i){unalignText(a)}else{alignText(a)}}}function nonce8Changed(d){var b=trimInputValue(d.currentTarget);var c=nonceChanged(b,8);var a=document.querySelector("#form8 .codeblock-container");if(!c.status){a.style.display="none";return}a.style.display="block";document.getElementById("nonce8Hex").innerHTML=int2hex(c.nonceInt);document.getElementById("nonce8Bytes").innerHTML=borderTheChars(int2hex(c.nonceInt,8),2);document.getElementById("nonce8BytesLE").innerHTML=borderTheChars(c.nonce,2)}function version9Changed(d){var a=trimInputValue(d.currentTarget);var c=versionChanged(a,9);var b=document.querySelector("#form9 .codeblock-container");if(!c.status){b.style.display="none";return}b.style.display="block";document.querySelector("#version9Output").innerHTML=borderTheChars(c.version,2);renderHashes9()}function prevHash9Changed(d){var b=trimInputValue(d.currentTarget);var c=prevHashChanged(b,9);var a=document.querySelector("#form9 .codeblock-container");if(!c.status){a.style.display="none";return}a.style.display="block";document.querySelector("#prevHash9Output").innerHTML=borderTheChars(c.prevHash,2);renderHashes9()}function merkleRoot9Changed(d){var c=trimInputValue(d.currentTarget);var b=merkleRootChanged(c,9);var a=document.querySelector("#form9 .codeblock-container");if(!b.status){a.style.display="none";return}a.style.display="block";document.querySelector("#merkleRoot9Output").innerHTML=borderTheChars(b.merkleRoot,2);renderHashes9()}function timestamp9Changed(c){var b=timestampChanged(c.currentTarget.value,9);var a=document.querySelector("#form9 .codeblock-container");if(!b.status){a.style.display="none";return}a.style.display="block";document.querySelector("#timestamp9Output").innerHTML=borderTheChars(b.timestamp,2);renderHashes9()}function bits9Changed(f){var d=trimInputValue(f.currentTarget);var b=true;var c=bitsChanged(d,b,9);var a=document.querySelector("#form9 .codeblock-container");if(!c.status){a.style.display="none";return}a.style.display="block";document.querySelector("#bits9Output").innerHTML=borderTheChars(c.bits,2);renderHashes9()}function nonce9Changed(d){var b=trimInputValue(d.currentTarget);var c=nonceChanged(b,9);var a=document.querySelector("#form9 .codeblock-container");if(!c.status){a.style.display="none";return}a.style.display="block";document.querySelector("#nonce9Output").innerHTML=borderTheChars(c.nonce,2);renderHashes9()}function renderHashes9(){var f=document.getElementById("block9Bytes").textContent;if(f.length!=160){return}var d=sjcl.codec.hex.toBits(f);var b=sjcl.hash.sha256.hash(d);var a=sjcl.hash.sha256.hash(b);var e=sjcl.codec.hex.fromBits(b);var c=sjcl.codec.hex.fromBits(a);document.getElementById("firstSHA256Output9").innerHTML=borderTheChars(e,2);document.getElementById("firstSHA256OutputLE9").innerHTML=borderTheChars(toLittleEndian(e),2);document.getElementById("secondSHA256Output9").innerHTML=borderTheChars(c,2);document.getElementById("secondSHA256OutputLE9").innerHTML=borderTheChars(toLittleEndian(c),2)}function runHash10Changed(){var c=document.getElementById("inputCheckbox10");var a=document.getElementById("inputMessage10").value;if(c.checked&&isHex(a)){a=sjcl.codec.hex.toBits(a)}else{c.checked=false}var b=sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(a));document.getElementById("sha256Output10").innerHTML=borderTheChars(b,2);document.getElementById("sha256OutputLE10").innerHTML=borderTheChars(toLittleEndian(b),2)}function initDifficultyAttempts(){ajax(siteGlobals.hexTrialAttemptsJSON,function(a){try{difficultyAttempts=JSON.parse(a).attemptsForHexCharacters;triggerEvent(document.getElementById("difficulty11"),"change");removeGlassCase("form11",permanently)}catch(b){}})}function difficulty11Changed(b){var a=parseInt(b.currentTarget.value);document.getElementById("difficulty11Calculation").innerHTML="(16<sup>"+a+"</sup>)/2 = "+addThousandCommas(difficultyAttempts[a])+" hashes on average"}function initBlockchainSVG(){var s=document.getElementById("blockchainSVG").contentDocument.getElementsByTagName("svg")[0];var y=s.getElementsByTagName("defs")[0];var l=s.getElementById("view");var r=1;var b=1;var a=function(F){if(F<txsPerBlock.length){return}var G=(Math.ceil(F/1000)*1000)-1;if(txsPerBlock.length>G){return}var H=Math.floor(F/1000)*1000;var E=H+"-"+G;ajax(siteGlobals.btcTxsPerBlockJSON[E],function(J){try{var I=JSON.parse(J).txsPerBlock;txsPerBlock=txsPerBlock.concat(I);removeGlassCase("dragableBlockchain",permanently)}catch(K){}})};a(1);var g=y.querySelectorAll(".btc-tx")[0].getBoundingClientRect().height;if(g==0){g=30}var B=function(J,G){var F=J.querySelectorAll(".btc-txs")[0];F.parentNode.replaceChild(F.cloneNode(false),F);var I=J.querySelectorAll(".btc-txs")[0];for(var H=0;H<txsPerBlock[G];H++){var E=y.querySelectorAll(".btc-tx")[0].cloneNode(true);E.setAttribute("transform","translate(0,"+(g*H)+")");E.getElementsByTagName("text")[0].textContent="transaction "+(H+1);I.appendChild(E)}};var w=s.getBoundingClientRect().width;var x=b;var c=s.getElementById("block").getBoundingClientRect().width;var e=s.getElementById("braces").getBoundingClientRect().width;var u=0;var v=7;for(var j=0;u<=(w*v);j++){var m=s.getElementById("block").cloneNode(true);m.getElementsByTagName("text")[0].textContent="block "+j;m.id="block"+j;m.setAttribute("transform","translate("+(u+x)+")");l.appendChild(m);if(c==0){c=l.querySelector(".btc-block").getBoundingClientRect().width}u+=x+c;x=15;var n=s.getElementById("braces").cloneNode(true);n.setAttribute("transform","translate("+(u+x)+",20)");l.appendChild(n);if(e==0){e=l.querySelector(".braces").getBoundingClientRect().width}u+=x+e}s.appendChild(y.querySelectorAll(".big-instructions")[0]);var f=c+e+(2*x);var k=Math.floor(w/f);var A=w*Math.floor(v/2);var q=function(){var N=l.getBoundingClientRect().left;var I=l.querySelectorAll(".btc-block");var L=parseInt(I[0].id.replace(/[a-z]/g,""));if((N>-A)&&(L==0)){return null}var J=Math.trunc((A+N)/f);if(J==0){return null}if(L<J){J=L}var G=N-b-(J*f);var H=l.getBoundingClientRect().top+r;l.setAttribute("transform","translate("+G+","+H+")");var F=(I[0].id.replace(/[0-9]/g,"")=="block")?"bloc":"block";var M=L;for(var K=0;K<I.length;K++){var E=M-J;I[K].id=F+E;I[K].getElementsByTagName("text")[0].textContent="block "+E;B(I[K],E);a(E+(v*k));M++}return{dx:G,dy:H}};var i=0,h=0;var D=0,C=0;var p=0,o=0;var t=false;var d=s.getBoundingClientRect().height;addEvent(s,"mousedown, touchstart",function(E){switch(E.type){case"touchstart":E.cancelBubble=true;i=E.touches[0].clientX;h=E.touches[0].clientY;break;case"mousedown":E.stopPropagation();i=E.clientX;h=E.clientY;break}t=true});var z=false;addEvent(s,"mousemove, touchmove",function(H){switch(H.type){case"touchmove":H.cancelBubble=true;break;case"mousemove":H.stopPropagation();break}if(!t){return}if(!z){s.removeChild(s.querySelectorAll(".big-instructions")[0]);z=true}switch(H.type){case"touchmove":var G=H.touches[0].clientX;var F=H.touches[0].clientY;break;case"mousemove":var G=H.clientX;var F=H.clientY;break}p=D+G-i;if(p>0){p=0}o=C+F-h;var E=l.getBoundingClientRect().height;if(o<(d-E-r)){o=d-E-r}if(o>0){o=0}l.setAttribute("transform","translate("+p+","+o+")")});addEvent(s,"mouseup, mouseleave, touchend",function(E){switch(E.type){case"touchmove":E.cancelBubble=true;break;case"mousemove":E.stopPropagation();break}if(!t){return}t=false;var F=q();D=(F==null)?p:F.dx;C=(F==null)?o:F.dy})};